<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HNE Grossing Guide Viewer</title>
  <style>
* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  background-color: #f5f5f5;
  color: #333;
  line-height: 1.6;
}
.header {
  background: linear-gradient(135deg, hsl(157, 100%, 22%) 0%, #1e293b 100%);
  color: white;
  padding: 15px 30px;
  display: flex;
  align-items: center;
  gap: 20px;
  border-bottom: 1px solid #334155;
}
.header-text h1 { color:#f8fafc; font-size: 1.4rem; }
.header-text p { font-size: 0.95rem; color:#cbd5e1; }

.main-container {
  display: flex;
  gap: 20px;
  padding: 20px;
  max-width: 1600px;
  margin: 0 auto;
  min-height: calc(100vh - 110px);
}

.nav-panel {
  flex: 0 0 38%;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  padding: 18px;
  overflow: hidden;
  max-height: calc(100vh - 140px);
  display: flex;
  flex-direction: column;
}

.preview-panel {
  flex: 1;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  padding: 18px;
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 140px);
}

.panel-header {
  font-size: 1.1rem;
  font-weight: 800;
  color: #000;
  padding-bottom: 12px;
  border-bottom: 2px solid #CFB87C;
  margin-bottom: 12px;
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
}

.search {
  width: 100%;
  padding: 10px 12px;
  border: 2px solid #ddd;
  border-radius: 8px;
  font-size: 0.95rem;
  margin-bottom: 12px;
}
.search:focus { outline:none; border-color:#CFB87C; }

.nav { overflow-y: auto; padding-right: 6px; flex: 1; }

.cat {
  margin-bottom: 10px;
  border: 1px solid #eee;
  border-radius: 8px;
  overflow: hidden;
}
.cat > button {
  width: 100%;
  text-align: left;
  padding: 12px 12px;
  font-weight: 800;
  border: none;
  background: #fafafa;
  cursor: pointer;
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
}
.cat > button:hover { background:#f2f2f2; }
.cat.open > button { background:#fff8e7; border-bottom:1px solid #eee; }

.items { display: none; padding: 10px 10px 12px 10px; background: white; }
.cat.open > .items { display:block; }

.item {
  width: 100%;
  text-align: left;
  padding: 10px 10px;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  background: white;
  cursor: pointer;
  margin-top: 8px;
  font-size: 0.95rem;
}
.item:hover { border-color:#CFB87C; background:#fffdf6; }
.item.active { border-color:#CFB87C; background:#fff8e7; }

.meta { font-size: 0.85rem; color: #6b7280; }

.preview-title { font-size: 1.0rem; font-weight: 900; margin-bottom: 10px; }
.preview-content {
  flex: 1;
  overflow-y: auto;
  font-family: 'Segoe UI', Roboto, Arial, sans-serif;
  font-size: 0.93rem;
  line-height: 1.55;
  padding: 15px;
  background: #fafafa;
  border: 1px solid #eee;
  border-radius: 8px;
  margin-bottom: 12px;
}
.template-section + .template-section { margin-top: 14px; border-top: 1px solid #e5e7eb; padding-top: 12px; }
.template-heading { font-size: 0.95rem; font-weight: 900; margin-bottom: 6px; color: #111827; }
.template-line { margin: 0 0 8px 0; white-space: pre-wrap; }
.path { font-size: 0.82rem; color: #6b7280; margin-top: 6px; }

.button-row { display: flex; gap: 10px; flex-wrap: wrap; }
.btn {
  padding: 12px 18px;
  border-radius: 10px;
  font-size: 0.95rem;
  font-weight: 900;
  cursor: pointer;
  border: 2px solid #CFB87C;
  background: #000;
  color: #CFB87C;
  transition: all 0.2s;
}
.btn:hover { background:#CFB87C; color:#000; }
.btn.secondary {
  border-color: #475569;
  background:#111827;
  color:#e2e8f0;
}
.btn.secondary:hover { background:#334155; color:#e2e8f0; }
.btn.copied { background: #28a745; border-color: #28a745; color: white; }

.footer { text-align: center; padding: 15px; color: #888; font-size: 0.8rem; border-top: 1px solid #eee; }

@media (prefers-color-scheme: dark) {
  body { background-color:#0f172a; color:#e2e8f0; }
  .nav-panel, .preview-panel { background:#111827; border: 1px solid #334155; box-shadow: 0 2px 10px rgba(0,0,0,0.45); }
  .panel-header { color:#e2e8f0; border-bottom-color:#CFB87C; }
  .search { background:#0f172a; color:#e2e8f0; border-color:#475569; }
  .cat { border-color:#334155; }
  .cat > button { background:#0b1220; color:#e2e8f0; }
  .cat > button:hover { background:#111b31; }
  .cat.open > button { background:#3a2f18; border-bottom-color:#334155; }
  .items { background:#111827; }
  .item { background:#0f172a; color:#e2e8f0; border-color:#475569; }
  .item:hover { background:#1a2646; border-color:#CFB87C; }
  .item.active { background:#3a2f18; border-color:#CFB87C; }
  .preview-content { background:#0b1220; border-color:#334155; color:#e2e8f0; }
  .template-section + .template-section { border-top-color:#334155; }
  .template-heading { color:#f8fafc; }
  .meta, .footer { color:#cbd5e1; border-top-color:#334155; }
  .path { color:#94a3b8; }
}
</style>
</head>
<body>
  <div class="header">
    <div class="header-text">
      <h1>HNE Grossing Guide Viewer</h1>
      <p>Word-style headings on the left → full section text on the right</p>
    </div>
  </div>

  <div class="main-container">
    <div class="nav-panel">
      <div class="panel-header">
        <span>Headings</span>
        <span class="meta" id="countMeta"></span>
      </div>
      <input id="search" class="search" type="text" placeholder="Search headings or text (e.g. neck dissection, mandibulectomy)." />
      <div id="nav" class="nav"></div>
    </div>

    <div class="preview-panel">
      <div class="panel-header">
        <span>Preview</span>
        <div class="button-row">
          <button class="btn secondary" id="collapseAllBtn" type="button">Collapse</button>
          <button class="btn secondary" id="expandAllBtn" type="button">Expand</button>
          <button class="btn" id="copyBtn" type="button">Copy text</button>
        </div>
      </div>

      <div class="preview-title" id="previewTitle">Select a heading</div>
      <div class="path" id="previewPath"></div>
      <div class="preview-content" id="previewContent"></div>
    </div>
  </div>

  <div class="footer">
    Generated from <b>HNE Grossing Guide TEMPLATES.docx</b> — self-contained static HTML (no server needed)
  </div>

  <script id="hne-data" type="application/json">{"generated_from": "HNE Grossing Guide TEMPLATES.docx", "root": {"title": "HNE Grossing Guide", "level": 0, "children": [{"title": "HNE Grossing Guide", "level": 1, "children": [{"title": "HEAD AND NECK", "level": 2, "children": [{"title": "A.  Neck Dissection", "level": 3, "children": [], "content": ["Procedure:", "Orient the specimen. Is it a right or left neck dissection? If frozen sections were performed, consult respective resident/staff pathologist. Consult with the surgeon if necessary for accurate orientation.", "Is the internal jugular vein included? If so, the length should be stated. Is the vein invaded by tumor?", "Is the primary neoplasm present in the specimen? Is there metastatic tumor?", "Is there gross involvement of the lymph nodes, submaxillary salivary gland, soft tissue, or muscle by tumor? Measure the largest lymph node identified. Note whether extra nodal invasion is suspected grossly.", "Describe areas affected by disease, as well as, briefly, normal structures (salivary gland, muscle, etc).", "The lymph nodes are divided into groups/levels as per the accompanying diagrams, or following consultation with the surgeon. It is convenient to dissect the nodes of the different anatomical regions before fixing the specimen in formalin. ALL lymph nodes identified must be submitted for microscopic evaluation. Residual fibro adipose tissue (up to 5 blocks) should be submitted to identify non-palpable lymph nodes.", "In addition to the lymph nodes, take sections of the following structures when they are included in the specimen: parotid gland, submaxillary gland, thyroid and parathyroid glands, and internal jugular vein nearest to involved nodes.", "", "Description:", "State the overall dimensions of the specimen. State the length of the sternocleidomastoid muscle, if included", "If the internal jugular vein is present, the length should be stated. State whether the vein invaded by tumor.", "If the primary or metastatic neoplasm is present in the specimen, describe.", "State whether there is gross involvement of the lymph nodes, submaxillary salivary gland, soft tissue, or muscle by tumor", "Measure the largest lymph node identified. Note whether extra nodal invasion is suspected grossly.", "Describe the lymph nodes by their neck levels", "", "Sections for histology:", "Submit all lymph nodes identified", "Submit representative sections of any additional structures present (i.e., salivary gland; veins; muscle)", "Take and label the neck levels if possible:", "", "Header examples:", "Neck, left, radical dissection:", "", "Dictation example:", "“Dissect Neck”", "Received is a formalin container labeled \\"[patients name/MRN/location]\\" containing a [right][left], [oriented/unoriented] [selective/modified radical/ standard radical/extended radical] lymph node dissection specimen, [___ x ___ x ___] cm, containing levels [ ___ - ___] [and submandibular gland/sternocleidomastoid muscle/internal jugular vein]. The [short] suture designates [location] and the [long] suture designates [location] per the [EMR, requisition/surgeon].", "", "The submandibular gland, [___ x ___ x ___] cm, is [not] involved by tumor and has [tan and lobulated] cut surfaces. The sternocleidomastoid muscle, [___ x ___ x ___] cm, is red-brown and [unremarkable/adherent to adjacent lymph nodes/tumor]. The internal jugular vein, [___] cm in length x [___] cm in diameter and [involved/uninvolved] by tumor.", "", "There is a predominant [lymph node/lesion] in level [x], [___ x ___ x ___] cm, that involves [adjacent lymph nodes, is a matted lymph node/etc]. Multiple additional lymph nodes are palpated ranging from [___] cm to [___] cm throughout the specimen. All palpated lymph nodes are submitted per level as follows:", "", "[A1] Submandibular gland", "[A2] Level I lymph nodes", "[A3] Level II lymph nodes, including predominant lesion", "[A4] Level III lymph nodes", "[A5] Level IV lymph nodes", "[A6] Level V lymph nodes", "[A7] Superior jugular vein margin and skeletal muscle", "[A8] Inferior jugular vein margin and skeletal muscle"], "id": "n00003", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "A.  Neck Dissection"]}, {"title": "B.  Jaw Resection for Cancer", "level": 3, "children": [{"title": "Mandibulectomy", "level": 4, "children": [], "content": ["Procedure:", "Photograph the specimen.", "Fix the entire specimen in formalin overnight (if a mucosal or soft tissue tumor is present, serial section tumor to optimize fixation, noting if tumor grossly extends in to bone).", "Paint the surgical margins with ink.", "For bone tumors: Make multiple parallel sections with the handheld oscillating saw through bone, photograph and fix further in formalin before decalcification. ASK PA FOR HELP WITH THIS STEP! \\nNOTE: DO NOT ATTEMPT TO CUT THROUGH TEETH OR METAL!", "Take photographs. Draw a diagram and identify in one of them the site of the section taken.", "If the specimen includes a neck dissection, process according to instruction for \\"Neck Dissection\\".", "", "Description:", "Type of resection (partial or total) and size.", "Tumor: size in three dimensions, color, appearance, edges; bone invaded?", "Non-neoplastic mucosa: leukoplakia?", "Bone: appearance on cross-sections.", "Teeth: number and appearance (gross only).", "", "Sections for histology:", "Tumor: three sections (at least one including deepest extent of gross invasion)", "Non-neoplastic mucosa", "Perpendicular mucosal surgical margins", "Perpendicular soft tissue surgical margins", "Bone surgical margins", "Mandibular nerve (surgical margins). Note: inferior alveolar nerve is a branch of mandibular nerve", "Bone if grossly involved or suspicious", "", "Header examples:", "Mandible, right, hemimandibulectomy:", "", "Dictation example:", "“Lower Jaw”", "Received [fresh for frozen section diagnosis/tissue banking/in formalin] in a container labeled [patients name/MRN/designation], is a  [right/left/midline] [marginal/segmental] mandibulectomy specimen, [__ x __ x __] cm, with[out] the ramus and attached [soft tissue/floor of mouth/lymph node containing adipose]. There are [#] in situ/extracted teeth, which appear [carious, structurally normal, involved by tumor]. There is a [color, configuration, necrotic] mass, [__ x __ x __] cm, primarily involving [structures], with invasion into [structures]. The lesion is [___] cm to the anterior margin, [___] cm to the posterior margin, [___] cm to the superior margin, [___] cm to the medial margin, and [___] cm to the lateral margin. The oral/lingual mucosa is [color] and is [unremarkable/uninvolved/involved with the lesion] and with an associated [ulcer, plaque, area of leukoplakia] [__] x [__] cm.  The oral/lingual mucosa is [color] and is [unremarkable/uninvolved/involved with the lesion] and with an associated [ulcer, plaque, area of leukoplakia] [__ x __] cm. The specimen is inked as follows: Superior- [blue], inferior- [green], anterior- [red], posterior- [black], medial- [green], and lateral- [blue]. Gross photographs are taken and [representative] sections are submitted as follows:", "", "([A1-3]) [Mass to closest margin]", "([A3-4]) [Mass invading bone, following decalcification]", "([A5-7]) [Mass in floor of mouth]", "([A8]) [Anterior bone margin, en face, following decalcification]", "([A9]) [Posterior bone margin, en face, following decalcification]", "([A10]) [Posterior mucosal margin, perpendicular]", "([A11]) [Mucosal ulcer]", "([A12]) [Gingival plaque]"], "id": "n00005", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "B.  Jaw Resection for Cancer", "Mandibulectomy"]}, {"title": "Maxillectomy", "level": 4, "children": [], "content": ["Procedure:", "Photograph the specimen.", "Fix the specimen in formalin overnight if a mucosal or soft tissue tumor is present, serial section tumor to optimize fixation, noting if tumor grossly extends into bone)", "Paint the surgical margins with ink.", "Take perpendicular surgical margins (anterior, posterior, external and superior); cut the specimen with the handheld oscillating saw in parallel slices. Fix them overnight. Take photographs and images with our small x-ray machine (Faxitron) if indicated.", "Draw a diagram and identify the site of the sections taken.", "", "Description:", "Extent of resection, size.", "Presence of following structures: hard palate; soft palate; superior, middle, and inferior turbinates; medial and lateral pterygoid plate of sphenoid bone; air cells of ethmoid; bony floor of orbit; orbital contents, zygomatic arch; masseter, temporalis, external, and internal pterygoid muscles.", "Tumor characteristics: location, extent, size; limited to the maxillary sinus? involving superior, medial, lateral, anterior, posterior, or inferior part of sinus? extending into infratemporal fossa, nasal cavity, ethmoid cells, or any other of aforementioned structures? presence of tumor at surgical margins?", "Condition of ostium of maxillary sinus and any other sinuses present; fistulae present.", "", "Sections for histology:", "Tumor: as many sections as necessary, with a minimum of three, at least one including deepest extent of gross invasion)", "Perpendicular surgical margins", "Non neoplastic mucosa", "Bone if grossly involved or suspicious.", "", "Header example:", "Maxilla, maxillectomy:", "", "Dictation example:", "“Upper Jaw”", "Received [fresh for frozen section diagnosis/tissue banking/in formalin] in a container labeled [patients name/MRN/designation], is a [right/left/midline] [marginal/segmental] maxillectomy specimen, [__ x __ x __] cm, containing [hard/soft palate, turbinates/ nasal septum, bones/muscles/paranasal sinuses/orbital contents]. There are [#] in situ/extracted teeth, which appear [carious, structurally normal, involved by tumor]. There is a [color, configuration, necrotic] mass, [__ x __ x __] cm, primarily involving [structures], with invasion into [structures]. The lesion is [___] cm to the anterior margin, [___] cm to the posterior margin, [___] cm to the superior margin, [___] cm to the medial margin, and [___] cm to the lateral margin. The oral/lingual mucosa is [color] and is [unremarkable/uninvolved/involved with the lesion] and with an associated [ulcer, plaque, area of leukoplakia] [__] x [__] cm. The specimen is inked as follows: Superior- [blue], inferior- [green], anterior- [red], posterior- [black], medial- [green], and lateral- [blue]. Gross photographs are taken and representative sections are submitted as follows:", "", "([A1-2]) [Superior bone margin and mass, perpendicular, following decalcification]", "([A3]) [Anterior bone margin, en face, following decalcification]", "([A4]) [Posterior bone margin, en face, following decalcification]", "([A5]) [Medial bone margin, en face, following decalcification]", "([A6]) [Medial soft tissue margin, en face]", "([A7]) [Lateral bone margin, en face, following decalcification]", "([A8]) [Lateral soft tissue margin, en face]", "([A9-11]) [Mass (A10 = deepest invasion of bone, following decalcification)]", "([A12]) [Uninvolved hard palate mucosa]", "([A13]) [Uninvolved soft palate]"], "id": "n00006", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "B.  Jaw Resection for Cancer", "Maxillectomy"]}], "content": [], "id": "n00004", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "B.  Jaw Resection for Cancer"]}, {"title": "C.  SALIVARY GLAND - RESECTION FOR TUMOR", "level": 3, "children": [], "content": ["Procedure:", "Paint surgical margins with ink.", "Cut parallel sections and fix.", "Look for intraparotid lymph nodes and for major nerves in total parotidectomy specimens.", "If the specimen includes a neck dissection, process according to instructions for \\"Neck Dissection.\\"", "", "Description:", "Type of specimen: parotid lobectomy, total parotidectomy without facial nerve, total parotidectomy with facial nerve, total submandibulectomy; site of operation.", "Tumor: size, location, shape, distance from closest margin. Solitary or multiple? Cystic or solid? Encapsulated, circumscribed, or poorly defined? Hemorrhage or necrosis? Extra glandular extension?", "Appearance of non-neoplastic gland.", "Appearance of intraparotid and other lymph nodes.", "", "Sections for histology:", "Tumor: four or more, depending on size. Perpendicular capsule or tumor margins should be included.", "Non-neoplastic gland", "Surgical margins", "Facial nerve margins, if included", "Lymph nodes, if included", "", "Header example:", "Salivary gland, tumor, resection:", "", "Dictation example:", "“Gross gland”", "Received is a formalin container, labeled [patients name/MRN/location] is a [left/right] [superficial/deep/tail] of [parotid/ submandibular/sublingual] gland, [___ x ___ x ___] cm, [with attached fat/muscle/facial nerve].  There are attached designating sutures: short= superior, long = lateral.] The external surface is [color, fatty, smooth, rough, focally transected, involved by tumor] and is inked [blue]. There is a [___ x ___ x ___] cm [un]encapsulated, [round/ovoid/irregular mass], [#] cm from the nearest margin. The lesion has a [color, consistency, necrotic, infiltrative] cut surface, and does [not] appear to invade the facial nerve. A [___ x ___ x ___] cm tan-brown intraglandular lymph node does [not] appear involved by tumor. The surrounding parenchyma is [color, lobulated, largely replaced by fat, fibrotic]. Representative sections are submitted as follows:", "([A1]) Tumor", "([A2]) Uninvolved parenchyma"], "id": "n00007", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "C.  SALIVARY GLAND - RESECTION FOR TUMOR"]}, {"title": "D. LARYNX, PHARYNX AND HYPOPHARYNX", "level": 3, "children": [], "content": ["Procedure:", "Photograph the specimen", "Ink the outer surface of soft tissue margins", "Separate the larynx from the neck dissection specimen (if latter is included).", "Measure larynx and open it along the posterior midline.", "Photograph the opened specimen", "Fix in 10% formalin with a wooden stick to keep it open", "", "Description:", "Describe the lesion, noting especially its size, location and extent. Is the lesion an ulcerated or fungating tumor. Is it invasive?", "Describe the orientation of the specimen and provide overall measurements from anterior to posterior, left to right, and inferior to superior.", "Describe involvement in relation to supraglottic, glottic, subglottic, anterior space, etc.", "", "Sections for histology:", "", "Take a shave margin of the inferior tracheal ring mucosal margin. If the tumor is within 1 cm of the inferior tracheal margin do a perpendicular section rather than a shave margin.", "Take superior margins (shave margins) of the residual right and left pharyngeal mucosa including arytenoids and aryepiglottic folds, if present.", "Take perpendicular sections of right, left, anterior and posterior soft tissue margins.", "Take perpendicular sections of right and left aryepiglottic folds to include the pyriform sinus.", "Take 1 section (perpendicular to the mucosa) of the epiglottis.", "Take 3 to 4 sections of the tumor perpendicular to the mucosa, to include the true and false vocal cords and ventricle.  The sections must be able to demonstrate the depth of invasion of the tumor and the extent of infiltration of any adjacent cartilage or soft tissue. Sections as well as gross description should describe and show any involvement of the thyroid cartilage, epiglottis, supraglottis, subglottis or contralateral vocal cords. If tumor is grossly unilateral take 1 or 2 sections from the contralateral vocal cords to document absence of involvement.", "If the tumor is confined to one side, section the anterior commissure. If the larynx is part of a larger surgical procedure, ask the attending pathologist about selecting blocks.", "Calcified and/or ossified thyroid cartilage can be cut with a sharp scalpel blade after brief decalcification. Look for tumor involvement of cartilage and document it with a section.", "Submit sections of hyoid bone overlying the tumor for decalcification if grossly involved by tumor. If hyoid bone is not grossly involved no section is needed", "Look for thyroid and parathyroid glands, and submit representative blocks at the site of maximum tumor invasion (if any).", "", "Header example:", "Larynx, laryngectomy:", "", "Dictation examples:", "“Larynx Gross”", "Received [without fixative and subsequently placed in formalin] in a container labeled \\"[patient's name/MRN/location]\\", is a [total/hemi-/partial/supraglottic] laryngectomy specimen, [___ x ___ x ____] cm, with attached [hyoid bone], and [__ x __ x __] cm [left/right/total] thyroid [lobe/gland]. A [__ x __] cm tracheal stoma is [#] cm from the distal margin anteriorly. There is a [color, shape, ulceration] [supraglottic/glottic/transglottic/subglottic] mass, [_L_ x _W_] cm, and [#] cm in elevation, involving [the larynx and right thyroid]. It does [not] cross the midline, [focally/extensively] involving the [left/right soft tissues/hyoid/etc]. The [left/right] aryepiglottic fold/arytenoid mucosal margin is [#] cm from the mass. [#] of a total [#] tracheal rings are involved by the mass. The mass is [#] cm from the distal (tracheal) margin. The mass appears [restricted to the mucosa, focally/extensively invasive] and infiltrates [thyroid cartilage, anterior soft tissues, left/right thyroid]. The [_____, _____, and _____] are not involved by the mass. There is a [__ x __] cm [color, ulcer, plaque] involving the mucosa of the [_____], [distinct from/adjacent to] the tumor. The thyroid gland has a [color, consistency] cut surface. [One left/right superior/inferior _____ (color) parathyroid gland, __ x __ x __ cm is identified.] The tracheal stoma is involved/uninvolved by tumor. Resection margins are inked as follows: [tracheal margin = _____, left/right mucosal margins _____, left/right base of tongue margin _____, left/right anterior/lateral/posterior soft tissue margins = _____]. [Multiple] possible lymph nodes, up to [#] cm in greatest dimension, are identified and entirely submitted in addition to representative sections of the specimen as follows:", "", "([A1]) Tracheal margin, en face", "([A2-3]) Left ([A2]) and right ([A3]) aryepiglottic folds mucosal margins, en face", "([A4-5]) Left ([A4]) and right ([A5]) arytenoid mucosal margins, en face", "([A6]) Epiglottis with ulcerated mucosa", "([A7-9]) Entire mass from left to right, including soft tissue perpendicular margins:", "([A10]) Slice [1], superior and inferior", "([A11-12]) Slice [2] left cords and ventricle, superior and inferior", "([A13-14]) Slice [3] left cords and ventricle (__A14 for decal), superior, inferior mucosal, and inferior deep", "([A15-16]) Slice [4] midline, superior and inferior", "([A17-18]) Slice [5] right cords and ventricle, superior and inferior", "([A19-20]) Left [(A19)] and right [(A20)] base of tongue perpendicular margins", "([A21]) Thyroid cartilage nearest mass, following decalcification", "([A22]) Hyoid, following decalcification", "([A23]) Edges of tracheostomy site", "([A24-25]) Left [(A24)] and right [(A25)] thyroid lobes", "([A26]) Entire parathyroid gland"], "id": "n00008", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "D. LARYNX, PHARYNX AND HYPOPHARYNX"]}, {"title": "E. TONSILS AND ADENOIDS", "level": 3, "children": [], "content": ["Procedure:", "Often removed for recurrent tonsillitis, obstructive sleep apnea, or middle ear infections, but rarely may be involved by hematolymphoid malignancy, carcinoma, or granulomatous processes", "Rarely, bilateral or unilateral tonsillectomy may be done in a patient with metastatic squamous cell carcinoma in a neck lymph node with unknown primary.", "", "Description:", "Make note if one tonsil is asymmetrically enlarged. If there is suspicion of squamous cell carcinoma, ink the cauterized base of the tonsil and examine for gross tumor involvement.", "Measure, weigh, and describe the specimen", "Serially section through the tonsil; the cut surfaces should be lobulated, and friable yellow-green “sulfur” granules, representing Actinomyces colonies, may be grossly identified within tonsillar crypts.", "Submit one representative section per tonsil.", "If there is suspicion of lymphoma (e.g. unilateral enlargement, past clinical history, post-transplant setting etc), then perform lymphoma workup if fresh tissue is available", "", "Sections for histology:", "Submit one representative section per tonsil.", "If mass/lesion identified, take additional sections.", "", "Tonsils:", "Header example:", "Tonsil, bilateral, tonsillectomy:", "", "Dictation example:", "“Tonsil Gross”", "Received is a formalin container labeled \\"[Patient name/MRN/Designation]\\" containing a [___]g, [pink-tan, partially cauterized] palatine tonsil, [___ x ___ x ____] cm. Cut surfaces demonstrate a [pink tan, soft ]cut surface with [empty] cerebriform crypts.  A representative section is submitted in ([A1]).", "", "Adenoids:", "Header:", "Adenoid, left, adenoidectomy:", "", "Dictation example:", "“Adenoid Gross”", "Received is a formalin container labeled \\"[Patient name/MRN/Desgination]\\" containing [multiple irregular fragments of soft pink tan tissue], [___ x ___ x ___] cm in aggregate. The fragments are serially sectioned revealing [pink tan, soft cut surfaces].  A representative section is submitted in ([A1])."], "id": "n00009", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "E. TONSILS AND ADENOIDS"]}, {"title": "F.  SINUS CONTENTS", "level": 3, "children": [], "content": ["Header example:", "Sinus contents, left, excision:", "", "Dictation example:", "“Sinus contents gross”", "Received is a formalin container labeled \\"[Patient name/MRN/Desgination]\\" containing [numerous irregular fragments of pink tan fibrous] [soft tissue, bone and/or cartilage] [admixed with bloody mucoid material], [___ x ___ x ___] cm in aggregate.  Representative sections are submitted in ([A1])."], "id": "n00010", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "F.  SINUS CONTENTS"]}, {"title": "G. SEPTUM", "level": 3, "children": [], "content": ["Header example:", "Septum, biopsy:", "", "Dictation example:", "“Septum gross”", "Received is a formalin container labeled \\"[Patient name/MRN/Designation]\\" containing [multiple] irregular fragment[s] of white tan bone and cartilage, [___ x ___ x ___] cm [in aggregate].  [Representative sections are] submitted [following decalcification] in ([A1])."], "id": "n00011", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "G. SEPTUM"]}, {"title": "H.  EXTERNAL EAR", "level": 3, "children": [], "content": ["Header example:", "Pinna, auriculectomy:", "", "Dictation example:", "“Pinna”", "Received is a [fresh/formalin] container, labeled \\"[patient name/MRN/Source]\\" and contains a wedge resection of [partial/total external ear], [__ x __ x __] cm, consisting of [helix/antihelix/concha/tragus/lobule]. The specimen is oriented with a suture [___]. There is a [__ x __ x __] cm [color, ulceration, shape, borders] mass on the [_____], [__] cm from the [_____] resection margin and [__] cm from the [_____] resection margin. It has a [_____] cut surface and a thickness of [__] cm. It does [not] invade the underlying cartilage. The uninvolved skin is [color, texture, atrophy, erosion, flaking].", "([A1-2)] Resection margins, en face", "([A3-7)]  Entire tumor", "([A8)]  Erythematous skin", "([A9)] Skin with erosion"], "id": "n00012", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "H.  EXTERNAL EAR"]}, {"title": "I.  GLOSSECTOMY:", "level": 3, "children": [], "content": ["Header example:", "Tongue, left, hemiglossectomy:", "", "Dictation Sample:", "“Tongue Gross”", "Received in a [fresh/formalin] container labeled, \\"[Patient name/MRN/site]\\" is a [left/right] [hemi-/partial/total] glossectomy specimen [__] cm length, [__] cm width, [__] cm thickness, with a suture marking the [_____] aspect. There is a [__ x __ x __] cm [color, shape, ulceration, borders] [mass, plaque, ulcer] on the [left/right upper/lower/lateral] surface. It has a [color, consistency] cut surface and a depth of invasion/thickness of [__] cm that is [__] cm from the resection margin. The uninvolved mucosa is [color, ulceration, fibrosis, atrophy, irregularity], and the uninvolved muscle is [color, fibrosis, atrophy]. The resection margin is inked blue = [superior] and black = [inferior]. Representative sections are submitted as follows:", "([A1)-(A2)] Tumor with resection margin, perpendicular \\n([A3)-(A6)] Tumor and lateral border of tongue \\n([A7)] Tumor, deepest point of invasion \\n([A8)] Remainder of resection margin, en face \\n([A9)-(A10)] Uninvolved area"], "id": "n00013", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK", "I.  GLOSSECTOMY:"]}], "content": [], "id": "n00002", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "HEAD AND NECK"]}, {"title": "ENDOCRINE", "level": 2, "children": [{"title": "A. THYROID", "level": 3, "children": [], "content": ["Note: Prior to grossing the specimen, look up the ultrasound report and attempt to correlate imaging findings (number/location of nodules) with the gross findings. If possible, review laboratory data (e.g., TSH, T3, T4, Calcitonin, serologies for autoimmune process)", "", "Procedure:", "Weigh, measure the size of the organ (right lobe, left lobe, isthmus), dimensions of any abnormalities and location, presence/absence of parathyroid glands or possible lymph nodes.", "Paint with ink for orientation (right lobe, left lobe, and isthmus each in different colors)", "Anterior= blue, Posterior= black and Isthmus margin= orange if a lobectomy.", "Make few sections and let the gland fix for at least two hours.", "", "Description:", "Describe external surface", "Provide measurements of the organ (right lobe, left lobe, isthmus)", "State dimensions of any abnormalities and location. Describe them – i.e., circumscribed nodule, infiltrating, multinodular, etc.", "Describe its relationship to the capsule of the gland. Gross extra thyroidal extension of papillary thyroid carcinoma is prognostically important and its presence or absence should be commented upon.", "State the presence/absence of parathyroid glands or possible lymph nodes", "", "Sections for histology:", "Sections at 4 mm intervals", "Sections to submit:", "No obvious nodules: 1 section per cm lobe length.", "Solitary nodule up to 2 cm should be submitted entirely.", "Solitary nodule larger than 2 cm: submit entire tumor capsule including a 2 to 3 mm rim of underlying lesional tissue and of overlying parenchyma.", "Two to three sections of tumor capsule can be submitted per cassette.", "Multinodular goiter: 1 section per nodule, up to 10 sections per lobe and 2 sections per isthmus.", "", "Header example:", "Thyroid, right, hemithyroidectomy:", "", "Dictation example:", "“Thyroid Gross”", "Received [fresh / fresh for intra-operative consultation / in formalin] is a container labeled \\"[Patients name/MRN/Site]\\" is a [____] gram [total/hemi] thyroidectomy specimen consisting of right lobe [__ x __ x __] cm, left lobe [__x __ x __] cm, and isthmus [__ x __ x __] cm. A pyramidal lobe is [not] present [__ x __ x __] cm.] Parathyroid glands are [not] identified. [If present, note how many and describe.] The thyroid capsule is [smooth and intact] and inked as follows: [anterior- blue], [posterior- black] and [isthmus margin is inked orange]. The specimen is serially sectioned to reveal [describe any lesions/nodules], [__ x __ x __] cm, that are [#] cm from the anterior capsule, [#] cm from the posterior capsule, and [#] cm from the isthmus margin. The nodule[s] [is/are] [well circumscribed / color / solid / cystic / gelatinous / hemorrhagic / calcified]. The remainder of the thyroid parenchyma is beefy red and homogenous. Representative sections are submitted as follows:", "", "([A1]) Lesion to anterior capsule", "([A2]) Lesion to posterior capsule", "([A3]) Lesion to isthmus margin", "([A4]) Additional lesions", "([A5]) Uninvolved thyroid"], "id": "n00015", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "ENDOCRINE", "A. THYROID"]}, {"title": "B.  PARATHYROIDS", "level": 3, "children": [], "content": ["All glands should be weighed. Look for and describe fibrous bands, hemorrhage, necrosis and extraparathyroid extension. If any of the above are present, submit the entire gland (up to 10 sections). If absent, 1 section per cm is sufficient.", "", "Header example:", "Parathyroid, right superior, biopsy:", "", "Dictation example:", "“Para”", "Received is a fresh container entirely utilized for frozen section diagnosis labeled, \\"[Patients name/MRN/site]\\" containing a [__] gram [encapsulated] tan soft tissue, [ __ x __ x __] cm, and the frozen remnant is resubmitted in ([FSA1])."], "id": "n00016", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "ENDOCRINE", "B.  PARATHYROIDS"]}, {"title": "C.  ADRENALS", "level": 3, "children": [], "content": ["Procedure:", "Weighed and photographed", "Inked entirely without removing the fat (one color is fine) in the event the tumor is present at resected margin", "Weigh glands after careful dissection of peri-adrenal adipose tissue", "Serially sectioned perpendicular to the long axis (Adrenal glands should be sectioned in a plane perpendicular to their long axes, going from head to tail regions at intervals of 3 mm. Measure cortical thickness and note its color.)", "Any and all nodules/masses should be measured and described", "Photographs of cut sections taken", "", "Description:", "Describe overall configuration of glands, identify head (medial), body (middle) and tail (lateral) aspects, and measure length, width and thickness at the crest.", "Describe any irregularities (nodules, etc.) in cortex or medulla. (The medulla is concentrated in the head and body regions of the gland.)", "Describe the size and color of the nodule; look for extra adrenal spread and necrosis", "", "Sections for histology:", "For suspected metastatic carcinoma:", "If a grossly apparent metastasis is present, submit one complete cross-section of the gland, including the tumor.", "If there are no obvious metastases, one representative section from the head, body and tail should be submitted for microscopic study.", "For cortical hyperplasia:", "One representative section from head, body and tail.", "For cortical Nodules:", "Lesions less than 2 cm: submit nodule entirely including capsule and relationship to adjacent adrenal gland.", "Lesions larger than 2 cm: three cassettes plus an additional cassette for each 1 cm of greatest dimension, (up to 10 sections) including capsule, areas of hemorrhage, necrosis, and relationship to adjacent adrenal and soft tissue.", "If nodule is infiltrating into soft tissue, take the nearest perpendicular margin.", "Submit two additional sections of gland away from the nodule.", "For suspected pheochromocytoma:", "Depending upon the size of the tumors, submit two to four sections of the tumor, including the capsule, fixed in formalin.", "Submit at least two representative sections of the gland away from pheochromocytoma, including adjacent cortical and medullary tissue.", "For adrenal medullary hyperplasia:", "After fixation in formalin, submit all sections from head, body and tail regions, sequentially labeled, for routine sectioning.", "", "Header example:", "Adrenal, right, adrenalectomy:", "", "Dictation example:", "“Adrenal Gross”", "Received is a [fresh/formalin] container labeled \\"[Patients name/MRN/Site]\\" containing an [__] gram, unoriented yellow lobulated adipose encasing an adrenal gland, [__ x __ x __] cm overall.  The outer surface is inked [blue]. Cut surfaces demonstrate a [focally ruptured] adrenal gland, [__ x __ x __] cm.  Protruding from the gland is an encapsulated mass, [__ x __ x __] cm, which is [__] cm from the closest inked surface and staple line. The uninvolved gland is [tan yellow to red-brown with grossly distinguishable cortex and medulla].  Photographs are taken. [Pieces of the specimen were taken for biobanking.] Representative sections are submitted as follows:", "", "([A1)] Shaved surgical stapled resection margin", "([A2-A4)] Tumor with capsule", "([A5-A8)] Tumor with fat", "([A9)] Tumor with noninvolved adrenal", "([A10)] Uninvolved adrenal"], "id": "n00017", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "ENDOCRINE", "C.  ADRENALS"]}], "content": [], "id": "n00014", "path": ["HNE Grossing Guide", "HNE Grossing Guide", "ENDOCRINE"]}], "content": ["Principle:", "To describe the procedures to be followed in the Cutting Room/Frozen Section Rooms of Head and Neck, and Endocrine organs. This section describes all the procedures that need to be followed to ensure that specimens are prepared, handled, and disposed of properly.", "", "Scope", "This protocol applies to the procedure and dictation for Head and Neck, and Endocrine specimens.", "", "Safety", "Scrubs, fluid resistant gowns, gloves, goggles, safety glasses, face shields, masks and/or respirators are to be always worn when handling specimens and/or requisitions."], "id": "n00001", "path": ["HNE Grossing Guide", "HNE Grossing Guide"]}, {"title": "Additional Resources", "level": 1, "children": [], "content": ["Books:", "", "WHO Classification of Head and Neck Tumors, 4th Edition, 2017", "WHO Classification of Tumors of Endocrine Organs, 4th Edition, 2017", "Atlas of Head and Neck Pathology, Wenig, 3rd Edition, 2016", "Endocrine Pathology, Asa, 1st Edition, 2016", "", "Online:", "", "PathPrimer", "ExpertPath"], "id": "n00018", "path": ["HNE Grossing Guide", "Additional Resources"]}], "content": [], "id": "n00000", "path": ["HNE Grossing Guide"]}}</script>
  <script>
const DATA = JSON.parse(document.getElementById("hne-data").textContent);
const root = DATA.root;

const navEl = document.getElementById("nav");
const searchEl = document.getElementById("search");
const countMeta = document.getElementById("countMeta");

const previewTitleEl = document.getElementById("previewTitle");
const previewPathEl = document.getElementById("previewPath");
const previewContentEl = document.getElementById("previewContent");
const copyBtn = document.getElementById("copyBtn");
const expandAllBtn = document.getElementById("expandAllBtn");
const collapseAllBtn = document.getElementById("collapseAllBtn");

let activeId = null;
let catButtons = [];
let itemButtons = [];

function nodeText(node) {
  const body = (node.content || []).join("\n");
  return body;
}

function nodePath(node){
  return (node.path || []).join(" › ");
}

function makeCat(node) {
  const cat = document.createElement("div");
  cat.className = "cat";
  cat.dataset.id = node.id;

  const btn = document.createElement("button");
  btn.type = "button";

  const left = document.createElement("span");
  left.textContent = node.title;

  const right = document.createElement("span");
  right.className = "meta";
  right.textContent = node.children?.length ? String(node.children.length) : "";

  btn.appendChild(left);
  btn.appendChild(right);

  const items = document.createElement("div");
  items.className = "items";

  btn.addEventListener("click", () => {
    cat.classList.toggle("open");
    // Clicking the category header ALSO previews that category's content (if any)
    if ((node.content || []).length) {
      setActive(node.id);
      renderPreview(node);
    }
  });

  cat.appendChild(btn);
  cat.appendChild(items);

  catButtons.push(btn);

  return { cat, items };
}

function makeItem(node) {
  const b = document.createElement("button");
  b.className = "item";
  b.type = "button";
  b.dataset.id = node.id;
  b.textContent = node.title;

  b.addEventListener("click", () => {
    setActive(node.id);
    renderPreview(node);
  });

  itemButtons.push(b);
  return b;
}

function renderTree(parentEl, node, depth = 0) {
  // Root isn't shown as a collapsible category; show its children
  const children = node.children || [];
  for (const child of children) {
    const hasKids = (child.children || []).length > 0;
    if (hasKids) {
      const { cat, items } = makeCat(child);
      parentEl.appendChild(cat);

      // If this node also has direct content, add a "View" item to make it obvious
      if ((child.content || []).length) {
        const viewBtn = makeItem({ ...child, title: "▶ View: " + child.title });
        items.appendChild(viewBtn);
      }

      renderTree(items, child, depth + 1);
    } else {
      parentEl.appendChild(makeItem(child));
    }
  }
}

function clearNav() {
  navEl.innerHTML = "";
  catButtons = [];
  itemButtons = [];
}

function setActive(id) {
  activeId = id;
  document.querySelectorAll(".item.active").forEach(el => el.classList.remove("active"));
  const active = document.querySelector(`.item[data-id="${CSS.escape(id)}"]`);
  if (active) active.classList.add("active");
}

function renderPreview(node) {
  previewTitleEl.textContent = node.title;
  previewPathEl.textContent = nodePath(node);
  const lines = (node.content || []);
  if (!lines.length) {
    previewContentEl.innerHTML = `<div class="template-section">
      <div class="template-heading">No body text under this heading</div>
      <div class="template-line">(Tip: put the narrative content under this heading in Word, not in the heading itself.)</div>
    </div>`;
    return;
  }

  // Heuristic sectioning: split on "Procedure:", "Description:", "Sections for histology:", "Header example(s):", "Dictation example(s):"
  const markers = [
    /^Procedure:$/i,
    /^Description:$/i,
    /^Sections for histology:$/i,
    /^Header examples?:$/i,
    /^Dictation examples?:$/i,
  ];

  const sections = [];
  let current = { heading: "Text", lines: [] };

  for (const line of lines) {
    const trimmed = line.trim();
    const isMarker = markers.some(rx => rx.test(trimmed));
    if (isMarker) {
      if (current.lines.length) sections.push(current);
      current = { heading: trimmed, lines: [] };
    } else {
      current.lines.push(line);
    }
  }
  if (current.lines.length) sections.push(current);
  if (!sections.length) sections.push({ heading: "Text", lines });

  previewContentEl.innerHTML = sections.map(sec => {
    const body = sec.lines.map(l => `<div class="template-line">${escapeHtml(l)}</div>`).join("");
    return `<div class="template-section">
      <div class="template-heading">${escapeHtml(sec.heading)}</div>
      ${body}
    </div>`;
  }).join("");

}

function escapeHtml(s) {
  return String(s)
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;")
    .replaceAll('"', "&quot;")
    .replaceAll("'", "&#39;");
}

function walk(node, fn) {
  fn(node);
  for (const ch of (node.children || [])) walk(ch, fn);
}

function findById(id) {
  let found = null;
  walk(root, (n) => { if (n.id === id) found = n; });
  return found;
}

function filterTree(query) {
  const q = query.trim().toLowerCase();
  if (!q) return root;

  // clone + filter: keep node if it matches title/content OR has matching descendants
  function cloneFiltered(node) {
    const title = (node.title || "").toLowerCase();
    const body = nodeText(node).toLowerCase();
    const selfMatch = title.includes(q) || body.includes(q) || nodePath(node).toLowerCase().includes(q);

    const kids = (node.children || []).map(cloneFiltered).filter(Boolean);

    if (node.level === 0) {
      return { ...node, children: kids };
    }

    if (selfMatch || kids.length) {
      return { ...node, children: kids };
    }
    return null;
  }

  return cloneFiltered(root);
}

function countLeaves(node) {
  let count = 0;
  walk(node, (n) => {
    const hasKids = (n.children || []).length > 0;
    if (n.level > 0 && !hasKids) count += 1;
  });
  return count;
}

function rebuildNav(query) {
  clearNav();
  const filtered = filterTree(query);
  renderTree(navEl, filtered);

  // open the top-level cats when searching
  if (query.trim()) {
    document.querySelectorAll(".cat").forEach(c => c.classList.add("open"));
  } else {
    // open first top-level for convenience
    const first = document.querySelector(".cat");
    if (first) first.classList.add("open");
  }

  countMeta.textContent = `${countLeaves(filtered)} item(s)`;
}

copyBtn.addEventListener("click", async () => {
  const node = activeId ? findById(activeId) : null;
  if (!node) return;

  const txt = nodeText(node);
  try {
    await navigator.clipboard.writeText(txt);
    copyBtn.classList.add("copied");
    copyBtn.textContent = "Copied!";
    setTimeout(() => {
      copyBtn.classList.remove("copied");
      copyBtn.textContent = "Copy text";
    }, 900);
  } catch (e) {
    alert("Clipboard blocked by browser. You can still select + copy manually.");
  }
});

expandAllBtn.addEventListener("click", () => {
  document.querySelectorAll(".cat").forEach(c => c.classList.add("open"));
});
collapseAllBtn.addEventListener("click", () => {
  document.querySelectorAll(".cat").forEach(c => c.classList.remove("open"));
});

searchEl.addEventListener("input", () => rebuildNav(searchEl.value));

// Initial build
rebuildNav("");

// Auto-select first leaf item
setTimeout(() => {
  const firstItem = document.querySelector(".item");
  if (firstItem) firstItem.click();
}, 0);
</script>
</body>
</html>
